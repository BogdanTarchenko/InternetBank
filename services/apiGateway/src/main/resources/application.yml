server:
  port: 8080

spring:
  application:
    name: apiGateway

jwt:
  secret: b9b53b57953b23858fb6e4340673eee9066336281dc2b7ae3550a9759cef4ded

cors:
  allowed-origins:
    - http://localhost:3000
    - http://localhost:5173

services:
  user-service: http://localhost:8081
  core-service: http://localhost:8082
  credit-service: http://localhost:8083

gateway:
  routes:
    - path: /auth/**
      target: ${services.user-service}
      requires-auth: false
      client-id: api-gateway
      api-token: gateway-api-token

    - path: /users/**
      target: ${services.user-service}
      requires-auth: true
      client-id: api-gateway
      api-token: gateway-api-token

    # coreService (8082) ──────────────────────────────────────────────────
    # Client: POST/GET/DELETE /client/accounts, deposit/withdraw, operations
    # Employee: GET /employee/accounts, /employee/accounts/{id}/operations
    - path: /core/client/**
      target: ${services.core-service}
      requires-auth: true
      strip-prefix: /core
      client-id: api-gateway
      api-token: gateway-api-token

    - path: /core/employee/**
      target: ${services.core-service}
      requires-auth: true
      strip-prefix: /core
      client-id: api-gateway
      api-token: gateway-api-token

    # creditService (8083) ────────────────────────────────────────────────
    # Client: POST /client/credits, POST /client/credits/{id}/repay
    # Employee: POST /employee/tariffs, GET /employee/clients/{userId}/credits, GET /employee/credits/{creditId}
    - path: /credit/client/**
      target: ${services.credit-service}
      requires-auth: true
      strip-prefix: /credit
      client-id: api-gateway
      api-token: gateway-api-token

    - path: /credit/employee/**
      target: ${services.credit-service}
      requires-auth: true
      strip-prefix: /credit
      client-id: api-gateway
      api-token: gateway-api-token
